function fAddClass(e,t){for(var a=e.className?e.className.split(" "):[],s=0;s<a.length;s++)if(a[s]==t)return;a.push(t),e.className=a.join(" ")}function fRemoveClass(e,t){for(var a=e.className.split(" "),s=0;s<a.length;s++)a[s]==t&&(a.splice(s,1),s--);e.className=a.join(" ")}function fCreateElement(){var e=document.createElement(arguments[0]);if(arguments.length>1&&"object"==typeof arguments[1])for(var t in arguments[1])e[t]=arguments[1][t];return e}var CalcAndDrawPlugin={a:{min:6,max:9},b:{},s:{min:11,max:14},init:function(e){this.setterms();var t=this,a=fCreateElement("div",{id:"formula"}),s=fCreateElement("span",{className:"",innerHTML:this.a.val}),r=fCreateElement("span",{innerHTML:this.b.val}),n=fCreateElement("input",{type:"number",disabled:!0,className:"term metamorphosis",placeholder:"?"});e.appendChild(a),a.appendChild(s),a.appendChild(document.createTextNode(" + ")),a.appendChild(r),a.appendChild(document.createTextNode(" = ")),a.appendChild(n),this.s.target=n,n.addEventListener("input",function(){t.checkcorrect(t.s)});var i=fCreateElement("div",{id:"scale"});e.appendChild(i);var l=fCreateElement("div",{className:"number"+this.a.val});i.appendChild(l);var d=fCreateElement("input",{type:"number",id:"a",className:"term"});this.a.target=d,l.appendChild(d),this.a.label=s,d.addEventListener("input",function(){t.checkcorrect(t.a)}),this.drawarrow(l);var o=fCreateElement("div",{className:"number"+this.s.val});i.appendChild(o);var h=fCreateElement("input",{type:"number",id:"b",className:"term"});this.b.target=h,o.appendChild(h),this.b.label=r,h.addEventListener("input",function(){t.checkcorrect(t.b)}),this.drawarrow(o),this.a.target.focus()},setterms:function(){this.a.val=this.randomize(this.a.min,this.a.max),this.s.val=this.randomize(this.s.min,this.s.max),this.b.val=this.s.val-this.a.val},randomize:function(e,t){return Math.round(e-.5+Math.random()*(t-e+1))},checkcorrect:function(e){var t=e.target;+t.value==e.val?(fRemoveClass(t,"error"),void 0!==e.label&&fRemoveClass(e.label,"error"),fAddClass(t,"metamorphosis"),t.disabled=!0,e==this.a?(fRemoveClass(this.b.target.parentNode,"js-vhidden"),this.b.target.focus()):e==this.b?(fRemoveClass(this.s.target,"metamorphosis"),this.s.target.disabled=null,this.s.target.placeholder="",this.s.target.focus()):alert("Congratulations!")):(fAddClass(t,"error"),void 0!==e.label&&fAddClass(e.label,"error"))},drawarrow:function(e){var t={6:235,7:274,8:313,9:352,11:430,12:469,13:508,14:547},a=t[e.className.substr(6)];null!==e.previousSibling&&(a-=t[e.parentNode.childNodes[0].className.substr(6)]);var s=Math.round(a/2);e.style.marginTop="-"+Math.round(s/2-26)+"px";var r=Math.round(a/2),n=Math.round(s/2),i=SVG.createElement("svg",{width:a,height:s,class:"halfclip"}),l=SVG.createElement("ellipse",{rx:r,ry:n,cx:r,cy:n,strock:"#da2f59","strock-width":2});if(arr=SVG.createElement("polygon",{points:[a-8+","+(n-13),a-2+","+(n-7),a+","+(n-16)].join(" "),fill:"#da2f59"}),e.appendChild(i),i.appendChild(l),i.appendChild(arr),null!==e.previousSibling){var d=t[e.parentNode.childNodes[0].className.substr(6)];i.style.marginLeft=d+"px",e.childNodes[0].style.marginLeft=d+Math.round(a/2-10)+"px",fAddClass(e,"js-vhidden")}}},SVG={svgns:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",createElement:function(e,t){var a=document.createElementNS(SVG.svgns,e);return t&&SVG.setAttr(a,t),a},setAttr:function(e,t){for(var a in t)e.setAttribute(a,t[a]);return e}};document.addEventListener("DOMContentLoaded",function(e){CalcAndDrawPlugin.init(document.getElementById("CalcAndDraw"))});